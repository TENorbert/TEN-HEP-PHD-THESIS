%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% reconstruction.tex:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{  Particle Identification and Event Reconstruction}
\label{reconstruction_and Particle_ID_chapter}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Particle Reconstruction}
We describe the reconstruction of events as done in CMS focusing on photons,electrons, Jets and Missing Transverse energy
as these are th objects we study in this thesis.
or electrons in the ECAL.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Supercluster Reconstruction}
Electron reconstruction is based in the following sequence. We begin with supercluster (these are clusters of clusters) reconstruction followed by track seeds which are generated by producing  pairs of pixels hits tightly matched to a cluster pair. This is know as the supercluster driven approach.The electron trajectory is build using an algorithm which builds the electron trajectory based on pixel hits. This trajectory is then fitted to get the best tracked matched to supercluster using an algorithm called the Gaussian-Sum-Filter~(GSF).  Only one track is matched to a super cluster and from the fitted tracks we extract it's momentum and combining this with the cluster's energy though and electron algorithm we are able to reconstruct an electron called the GSFElectron. Pre-selections are applied at the level of track seeding and clusters so as to reject tracks from underlying or low energy proton-proton collision events called Pile Up~(PU). 
\newline
Electron reconstruction is done at track seeding stage using two major algorithms:
\begin{itemize} 
\item Tracker driven Seeding: more suitable for low $p_{T}$ electrons as well as better performance for electrons inside jets.
\item ECAL driven seeding: starts by reconstructing ECAL clusters of clusters~("Superclusters") of transverse energy $E_{T} > 4$~$GeV/c$ and optimised for isolated  electrons with some
    $p_{T}$ range  relevant for the mass of Z or W down to  $p_{T} 5$~$GeV/c$.
\end{itemize}

There are lots of good reason to study photons in a hadron collider. These reasons range from detector as well as physics 
as in the recent discovery of the higgs boson. However, the challenges to study photons are enormous. First photons don't 
leave any tracks in the tracker to the only way one can measure them is through their energy deposits in crystals in the ECAL
and it is not possible to tell from which vertex point did this energy deposit came from. Another major challenge is that
there are Jets everywhere in the detector arising from partons( quarks and gluons) fragmenting under QCD with a reasonable
proportion of neutral and electromagnetic components also depositing energy in ECAL making the jets look more photon-like.
An additional challenge come from high $p_{T}$ electrons which will undergo the process of Bremsstrahlung and produce
photons as these electrons interact with the tracker material sitting immediately in front of the ECAL crystals. 
Some contributions may arise from muons interacting with this tracker material through multiple Coulomb interaction, however, most 
of the times these contributions are small and can be easily modelled using Gaussian fluctuations. The electron Bremsstrahlung
photon emission is highly non-Gaussian and can only be modelled from the tracker point of view using the Kalman Filter (KF)
and a Gaussian-Sum Filter (GSM).
To overcome, these challenges, the photon reconstruction and identification is built to get the best estimate of the photon
energy and discriminate against as much jet background as possible.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Photon or Electron Reconstruction}
EM object reconstruction is begins with clusters of energy deposited in the ECAL. Clusters of Cluster called superclusters are used to reconstruct electrons and photon and also jet objects.


\subsection{Jet Reconstruction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Missing Transverse Energy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Using Timing in Particle Identification}
Timing of an event is extracted from the energy supercluster deposited on the
scintillating crystals of the ECAL. Using the seed crystal( basic cluster with highest energy), we can extract the time of arrival of a particular event as well as predict the vertex origin of the event and then use this to distinguish between events that occur within the LHC bunch collision called prompt events( photons)  from
events that arise from a new massive particle decaying into either photons 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Anomalous Signals}
Neutrons and charged hadrons such as protons may by pass the \pb without scintillating and striking and thus directly ionizing the silicon of the APDs to produce anomalous signals. These kind of events produced large isolated energy deposits thus are referred to as "punch through" events or "spikes". Because of the lack of scintillation, they appear much earlier (negative) in Ecal time and often populate the earlier time of the rechit time distribution. Their energy deposit ranges from a few \GeV to ECAL saturation energy of $\approx 1.7$ \TeV. Since they do not electromagnetically shower in \pb, their electromagnetic energy shower shape is  very isolated, meaning only one or two crystals may make up their energy cluster. Spikes may also have positive time and thus appear late or delayed in their arrival at ECAL which is seen in the tails of the rechit time distribution. Their late arrival time is due to the slow propagation of neutrons through the CMS detector.
A lot of test beam, collision data and simulation study has been performed to study and analyse the characteristics and rejection of spikes as seen in here \cite{spike}. 
As a result, most of the results presented in this thesis are taken directly from \cite{spike} or redone for 2012 dataset which this analysis is based upon. It has been observed through studies using minimum bias data set( highly populated with neutrons and  charged hadrons) at different center of mass energy, that the number of spikes increases with the proton collision rate as well as the charged tracks per event i.e there is a strong linear correlation between spike rate and the center of mass energy of pp collision. The reason for this is because more neutrons and charged hadrons with enough energy are produced which "punch through" the APD and produce hikes in the rechit energy profile as read from the APDs. It is understandable that spike production is most common in the barrel compared to the endcap. Thus with increases rate of proton collision and  $\sqrt{S} = 8$~\TeV, it is imperative to have robust variables which can identify and reject spikes in the barrel in this analysis.  
The  above studies show that variables defined using timing and EM energy deposits are reliable. Other variables using the timing pulse shape and EM shower profile can be use in addition to identify and rejects spikes with  efficiency of 90 to 95\%.
\newline
Rejection of spikes is done at online( CMS Level-1 trigger level) as well as offline and analysis level.
\newline
At online, the strip Fine-Grained Veto Bit(sFGVB) is set to 0 or 1 use to flagging an object as either a spike or a good event respectively. A detail of this can be found in \cite{spike2}. For example if the sFGVB is set to 0 and the  trigger tower( $5 \times 5$ crystals) transverse energy is below 12~\GeV, the energy deposition is considered spike-liked and the corresponding tower will not contribute  to CMS triggering of that event. The sFGVB was implemented in 2011 data taking process and was measured to reject over 95\% of spikes with transverse energy greater than 8~\GeV(12~\GeV) in 2011(2012).
The figure {\textbf{Figure of sFGVB}} shows the difference between an good EM-cluster and a spike-like cluster at sFGVB level.
\newline
At Offline, variables making using of the single(at times double) channel(crystal) energy deposit and early arrival time of spikes are defined.
In figure {\textbf{Figure of Swiss X and Rechit Time}}, we show the difference between spikes and normal events energy clusters explaining the variables used to identify spikes in the offline.
The topological variable constructed as $1 - \frac{E_{4}}{E_{1}}$ also known as "Swiss-cross" where $E_{1}$ is the energy deposit of the central( highest energy) crystals and $E_{4}$ is the sum of the energy of the neighbouring crystals in an $\eta - \phi $ plane is used for identifying isolated spikes.
The figure{\textbf{Figure of Spike energy topology and Distribution of SwissX}} shows the construction of the swiss-cross variable as well its distribution in data and simulation events. The peak at 1.0 in data of the distribution is due to the presence of spikes. A cut in Swiss-cross $ > 0.95$ rejects more than 99\% of isolated spikes with transverse energy greater than 10~\GeV with very little impact on the efficiency of selecting electromagnetic~{EM} showers.
Other topological energy deposit variables such as $ 1 - \frac{E_{2}}{E_{6}}$ and $ 1 - \frac{E_{2}}{E_{9}} $ where $E_{2}$ is the sum of the energy of two  crystals sharing the energy deposited and $E_{6}$($E_{9}$) is the sum of the neighbouring 6(pairs-of)(9) crystals in the $\eta - \phi$ plane.
The $ 1 - \frac{E_{2}}{E_{6}} $ variable is used for the identification of  isolated spikes whose energy deposit spread in two adjacent crystals while the  $ 1 - \frac{E_{2}}{E_{9}} $ is used to identify  non-isolated spikes or spikes which are found embedded in a normal Ecal supercluster.

The figure {\textbf{Put figure of di-spike and non-Isolated spike construction and distribution}}  
A cut on $ 1 - \frac{E_{2}}{E_{6}} $ ( $ 1 - \frac{E_{2}}{E_{9}} $)  greater than 0.95 ( 0.98 for tight) gives an efficiency close to 95\% for events with transverse energy greater than 10~\GeV for rejecting spikes with very little effect on normal EM shower reconstruction.
\newline
Another very important variable used for rejecting spikes with greater efficiency is rechit ECAL timing. Spikes and EM energy deposits show very distinct signal pulse shapes. Since spikes do not  in the \pb , when the pulse shape is fitted to extract the timing of a signal, the spikes appear "early" due to faster rise time of the spike pulse.
The figure {\textbf{Fig of spike pulse shape and rechit time distribution for data and simulation}} shows the comparison between the pulse shape for a spike candidate pulse and and true \pb scintillated event. The adjacent plots shows the distribution of the rechit time for simulation( where  there are no anomalous signals) and collision data where anomalous signals have a significant contribution to out-of-time signals.% timing distribution.
A cut on timing of $ \pm 3$~ns gives greater than 90\% efficiency for rejecting spikes however, in this thesis, we do not employ this timing cut as we are actually searching for delayed objects whose timing can be beyond the $\pm 3$~ns window.
\newline
However, it is worth nothing that, these anomalous signals if not rejected will lead to a biasing in the reconstruction of other physics variables such as missing transverse energy(~\MET) as well as being miss-identified as a possible signal for delayed photons.
Infact the spike rate per bunch crossing as observed in \cite{spike2} was approximately $ 1 \times 10^{-3}$ in collisions bunch crossings while in non-collision bunch crossing is of the order of $2 \times 10^{-6}$ in non-collision bunch crossings. This spike rate from non-collision rate is obtained from cosmic muon data recorded during June-August 2009 while the spike rate for collision is obtained from Minimum biased( Soft proton-proton) collision events data.
Thus, in this thesis, we have restricted ourselves to using only the energy topological variables discussed in previous paragraphs to identify and reject anomalous signals.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
